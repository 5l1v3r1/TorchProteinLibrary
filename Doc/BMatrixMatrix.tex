\subsection{B-matrix through forward operator}
Recall, that the derivatives of coordinates of the atom $i+1$ are:
$$ \frac{dr_i}{dq_j} = A_{j-1}  \cdot \frac{dR^j}{dq_j} R^{j+1} \dots R^{i} \cdot r_0 $$
We now have to compute inverse of this expression:
$$ \frac{dq_j}{dr_i} = \left( R^{j+1} \dots R^{i} \cdot r_0 \right)^{-1} \left(\frac{dR^j}{dq_j}\right)^{-1} \cdot A^{-1}_{j-1}$$
the matrixes $A$ are the products of transformations and is the transformation matrix itself.
The inverse of this matrix can be computed as follows:
$$A = \left(\begin{array}{cc}
R & u \\
0 & 1
\end{array}\right)$$

$$A^{-1} = \left(\begin{array}{cc}
R^T & -R^T \cdot u \\
0 & 1
\end{array}\right)$$

and the resulting expression for the derivatives is:

$$ \frac{dq_j}{dr_i} = r^T_0 A^{-1}_{i, j+1} \left(\frac{dR^j}{dq_j}\right)^{-1} \cdot A^{-1}_{j-1, 0}$$